# 嵌入

> 您可以在一个文档内嵌入其他文档和数组，这是 MongoDB 强大的特性之一，它允许更复杂的数据结构，而不仅仅是平面的键值对结构。这种嵌入式设计可以在很多场景中提高查询效率，因为你可以在一个数据库操作中检索到相关的数据，而不需要多次查询或进行类似于 SQL 中的 JOIN 操作。

以下是如何实现嵌入的示例：

1. **嵌入子文档**:

    ```json
    {
      "name": "John",
      "address": {
        "street": "123 Main St",
        "city": "Springfield",
        "state": "IL",
        "zip": "12345"
      }
    }
    ```

    在这里，`address` 字段是一个嵌入的文档。

2. **嵌入文档数组**:

    ```json
    {
      "name": "Jane",
      "orders": [
        {
          "product": "laptop",
          "quantity": 1,
          "date": "2023-01-10"
        },
        {
          "product": "phone",
          "quantity": 2,
          "date": "2023-02-01"
        }
      ]
    }
    ```

    这里的 `orders` 字段是一个包含多个文档的数组。

当你选择嵌入数据时，有些因素需要考虑：

1. **查询模式**：嵌入通常最适合于经常一起查询的数据。
2. **数据大小**：每个 MongoDB 文档的大小有限制（目前为 16MB），所以你需要确保嵌入的数据不会导致文档超过这个大小。
3. **更新模式**：如果嵌入的数据经常变动，或其大小经常变化，这可能会导致频繁的文档重新分配，从而影响性能。
4. **数据复用**：如果某些数据需要在多个地方复用，那么独立的集合和引用可能更合适，而不是嵌入。

通常，嵌入可以提供更好的读取性能，但可能会使写操作变得复杂。设计选择应基于应用的特定需求和访问模式。
